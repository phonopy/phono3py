
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Solution of the Wigner transport equation &#8212; Phono3py v.3.17.0</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=fde3a2e2"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'wigner-solution';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Workload distribution" href="workload-distribution.html" />
    <link rel="prev" title="Direct solution of linearized phonon Boltzmann equation" href="direct-solution.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">Phono3py v.3.17.0</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="interfaces.html">Interfaces to calculators (VASP, QE, CRYSTAL, Abinit, TURBOMOLE)</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="vasp.html">VASP &amp; phono3py calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="qe.html">Quantum ESPRESSO (pw) &amp; phono3py calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="crystal.html">CRYSTAL &amp; phono3py calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomole.html">TURBOMOLE &amp; phono3py calculation</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="command-options.html">Command options / Setting tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="input-output-files.html">Input / Output files</a></li>
<li class="toctree-l1"><a class="reference internal" href="auxiliary-tools.html">Auxiliary tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="direct-solution.html">Direct solution of linearized phonon Boltzmann equation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Solution of the Wigner transport equation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workload-distribution.html">Workload distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="random-displacements.html">Force constants calculation with random displacements of atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="pypolymlp.html">Force constants calculation using pypolymlp (machine learning potential)</a></li>
<li class="toctree-l1"><a class="reference internal" href="cutoff-pair.html">Force constants calculation with cutoff pair-distance</a></li>
<li class="toctree-l1"><a class="reference internal" href="external-tools.html">External tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="phono3py-api.html">Phono3py API</a></li>
<li class="toctree-l1"><a class="reference internal" href="phono3py-load.html">phono3py-load command</a></li>
<li class="toctree-l1"><a class="reference internal" href="hdf5_howto.html">Using phono3py hdf5 files</a></li>
<li class="toctree-l1"><a class="reference internal" href="grid.html">Grids in reciprocal space</a></li>
<li class="toctree-l1"><a class="reference internal" href="citation.html">How to cite phono3py</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Change Log</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/wigner-solution.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Solution of the Wigner transport equation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use">How to use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-the-wte-scattering-in-the-rta-approximation">Solution of the WTE, scattering in the RTA approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-the-wte-exact-treatment-of-scattering">Solution of the WTE, exact treatment of scattering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational cost</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="solution-of-the-wigner-transport-equation">
<span id="wigner-solution"></span><h1>Solution of the Wigner transport equation<a class="headerlink" href="#solution-of-the-wigner-transport-equation" title="Link to this heading">#</a></h1>
<p>This page explains how to compute the thermal conductivity from the solution of the Wigner transport equation (WTE)
<a class="reference external" href="https://doi.org/10.1038/s41567-019-0520-x">M. Simoncelli, N. Marzari, F. Mauri; Nat. Phys. 15, 809 (2019)</a>
(<a class="reference internal" href="citation.html#citation-unified-theory"><span class="std std-ref">citation</span></a>) and
<a class="reference external" href="https://doi.org/10.1103/PhysRevX.12.041011">M. Simoncelli, N. Marzari, F. Mauri; Phys. Rev. X 12, 041011 (2022)</a>
(<a class="reference internal" href="citation.html#citation-wigner-formulation"><span class="std std-ref">citation</span></a>).</p>
<p>The Wigner formulation of thermal transport in solids encompasses the emergence and coexistence of the particle-like propagation of phonon wavepackets discusses by Peierls for crystals [Peierls, Quantum theory of solids (Oxford Classics Series, 2001)], and the wave-like interband conduction mechanisms discussed by Allen and Feldman for harmonic glasses [
Allen and Feldman, Phys. Rev. Lett. 62, 645 (1989)]. As discussed in the references above, the Wigner formulation allows to describe the thermal conductivity of ordered crystals (where it yields practically the same result of the LBTE), of disordered glasses (where it generalizes Allen-Feldman theory accounting for anharmonicity), as well as of materials with intermediate characteristics (in this intermediate regime, both particle-like and wave-like conduction mechanisms are relevant, thus the Wigner formulation has to be used to obtain accurately predict the thermal conductivity).</p>
<p>In practice, the solution of the Wigner transport equation yields the following expression for the thermal conductivity tensor (we use <span class="math notranslate nohighlight">\(\alpha \beta\)</span> to denote Cartesian directions) <span class="math notranslate nohighlight">\(\kappa^{\alpha \beta}_{\rm T}=\kappa_P^{\alpha \beta}+\kappa_{\rm C}^{\alpha \beta}\)</span>, where <span class="math notranslate nohighlight">\(\kappa_{\rm P}^{\alpha \beta}\)</span> accounts for the particle-like propagation of phonon wavepackets and is exactly equivalent to the conductivity obtained solving the LBTE, while the other term <span class="math notranslate nohighlight">\(\kappa_{\rm C}^{\alpha \beta}\)</span> is the “coherences” conductivity and accounts for the wave-like tunneling of phonons between bands with an energy differences smaller than their linewidths.
Specifically, the expression for <span class="math notranslate nohighlight">\(\kappa_{\rm C}^{\alpha \beta}\)</span> reads:</p>
<div class="math notranslate nohighlight">
\[
\kappa^{\alpha \beta}_{\rm C}=\frac{\hbar^2}{k_{B} {T}^2}\frac{1}{\mathcal{V}N_{\rm c}}\sum_{\mathbf{q}}\sum_{s\neq s'}\frac{\omega(\mathbf{q})_{s}+\omega(\mathbf{q})_{s'}}{2}{{V}^\alpha}(\mathbf{q})_{s,s'}{{V}}^\beta(\mathbf{q})_{s',s}
\frac{\omega(\mathbf{q})_{s}\bar{{N}}^{T}({\mathbf{q}})_{s}[\bar{{N}}^{T}({\mathbf{q}})_{s}+1]+\omega(\mathbf{q})_{s'}\bar{{N}}^{T}({\mathbf{q}})_{s'}[\bar{{N}}^{T}({\mathbf{q}})_{s'}+1]}{4[\omega(\mathbf{q})_{s'}-\omega(\mathbf{q})_{s}]^2+[\Gamma(\mathbf{q})_{s}+\Gamma(\mathbf{q})_{s'}]^2}[\Gamma(\mathbf{q})_{s}+\Gamma(\mathbf{q})_{s'}],
\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{B}\)</span> is the Boltzmann constant, <span class="math notranslate nohighlight">\(\mathcal{V}\)</span> is the volume of the primitive cell, <span class="math notranslate nohighlight">\(N_{\rm c}\)</span> is the number of phonon wavevectors <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> used to sample the Brillouin zone, <span class="math notranslate nohighlight">\(\hbar\omega(\mathbf{q})_s\)</span> is the energy of the phonon with wavevector <span class="math notranslate nohighlight">\(\mathbf{q}\)</span> and mode <span class="math notranslate nohighlight">\(s\)</span>, <span class="math notranslate nohighlight">\({{V}^\alpha}(\mathbf{q})_{s,s'}\)</span> is the velocity operator in direction <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\bar{{N}}^{T}({\mathbf{q}})_{s}\)</span> is the Bose-Einstein distribution at temperature <span class="math notranslate nohighlight">\(T\)</span>, and <span class="math notranslate nohighlight">\(\Gamma(\mathbf{q})_{s}\)</span> is the phonon linewidth (full width at half maximum, i.e. the inverse phonon lifetime <span class="math notranslate nohighlight">\(\Gamma(\mathbf{q})_{s}=[\tau(\mathbf{q})_{s}]^{-1}\)</span>).</p>
<p>As discussed in the references above, the term <span class="math notranslate nohighlight">\(\kappa_{\rm P}^{\alpha \beta}\)</span> can be evaluated exactly or in the RTA approximation (the former corresponds to account for all the repumping/depumping scattering events, while the latter only for depumping scattering events). In contrast, the term <span class="math notranslate nohighlight">\(\kappa_{\rm C}^{\alpha \beta}\)</span> depends only on the depumping scattering events, thus it remains unchanged if scattering is considered exactly or in the RTA approximation.</p>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#how-to-use" id="id1">How to use</a></p>
<ul>
<li><p><a class="reference internal" href="#solution-of-the-wte-scattering-in-the-rta-approximation" id="id2">Solution of the WTE, scattering in the RTA approximation</a></p></li>
<li><p><a class="reference internal" href="#solution-of-the-wte-exact-treatment-of-scattering" id="id3">Solution of the WTE, exact treatment of scattering</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#computational-cost" id="id4">Computational cost</a></p></li>
</ul>
</nav>
<section id="how-to-use">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">How to use</a><a class="headerlink" href="#how-to-use" title="Link to this heading">#</a></h2>
<section id="solution-of-the-wte-scattering-in-the-rta-approximation">
<h3><a class="toc-backref" href="#id2" role="doc-backlink">Solution of the WTE, scattering in the RTA approximation</a><a class="headerlink" href="#solution-of-the-wte-scattering-in-the-rta-approximation" title="Link to this heading">#</a></h3>
<p>To compute the Wigner conductivity with scattering in the RTA approximation, specify <code class="docutils literal notranslate"><span class="pre">--br</span></code> and <code class="docutils literal notranslate"><span class="pre">--wigner</span></code>. For <code class="docutils literal notranslate"><span class="pre">example/Wigner_La2Zr2O7</span></code>, the command is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>phono3py<span class="w"> </span>--nac<span class="w"> </span>--cell<span class="w"> </span>POSCAR<span class="w"> </span>--fc2<span class="w"> </span>--dim<span class="o">=</span><span class="s2">&quot;2 2 2&quot;</span><span class="w"> </span>--dim-fc2<span class="o">=</span><span class="s2">&quot;4 4 4&quot;</span><span class="w"> </span>--mesh<span class="o">=</span><span class="s2">&quot;19 19 19&quot;</span><span class="w"> </span>--tmin<span class="o">=</span><span class="m">300</span><span class="w"> </span>--tmax<span class="o">=</span><span class="m">1000</span><span class="w"> </span>--tstep<span class="o">=</span><span class="m">700</span><span class="w"> </span>--fc-symmetry<span class="w"> </span>--isotope<span class="w"> </span>--br<span class="w"> </span>--wigner<span class="w"> </span>--read-gamma<span class="w"> </span>&gt;<span class="w"> </span>tc_La2Zr2O7.out
</pre></div>
</div>
<p>The example above uses the <code class="docutils literal notranslate"><span class="pre">--read-gamma</span></code> option to read the phonon linewidths stored in the file  <code class="docutils literal notranslate"><span class="pre">kappa-m191919.hdf5</span></code>. The calculation of these linewidths is computationally expensive, more details are reported in the <a class="reference internal" href="citation.html#citation-wigner-formulation"><span class="std std-ref">paper on the Wigner formulation</span></a>, and in this example the linewidths are provided.
To learn how to compute the linewidths, the reader is referred to the documentation of the <code class="docutils literal notranslate"><span class="pre">--write-gamma</span></code> option.
The RTA populations (particle-like) conductivity <span class="math notranslate nohighlight">\(\kappa_{\rm P}^{\alpha \beta}\)</span>, the coherences (wave-like) conductivity <span class="math notranslate nohighlight">\(\kappa_{\rm C}^{\alpha \beta}\)</span>, and the total conductivity <span class="math notranslate nohighlight">\(\kappa_{\rm T}^{\alpha \beta}=\kappa_{\rm P}^{\alpha \beta}+\kappa_{\rm C}^{\alpha \beta}\)</span> are reported at the end of the output file <code class="docutils literal notranslate"><span class="pre">tc_La2Zr2O7.out</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
<span class="o">===================</span><span class="w"> </span>End<span class="w"> </span>of<span class="w"> </span>collection<span class="w"> </span>of<span class="w"> </span><span class="nv">collisions</span><span class="w"> </span><span class="o">===================</span>
-----------<span class="w"> </span>Thermal<span class="w"> </span>conductivity<span class="w"> </span><span class="o">(</span>W/m-k<span class="o">)</span><span class="w"> </span>with<span class="w"> </span>tetrahedron<span class="w"> </span>method<span class="w"> </span>-----------
<span class="c1">#      	   T(K)        xx         yy         zz         yz         xz         xy</span>
K_P<span class="w">	  </span><span class="m">300</span>.0<span class="w">       </span><span class="m">1</span>.914<span class="w">      </span><span class="m">1</span>.914<span class="w">      </span><span class="m">1</span>.914<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
K_P<span class="w">	 </span><span class="m">1000</span>.0<span class="w">       </span><span class="m">0</span>.571<span class="w">      </span><span class="m">0</span>.571<span class="w">      </span><span class="m">0</span>.571<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000

K_C<span class="w">	  </span><span class="m">300</span>.0<span class="w">       </span><span class="m">0</span>.533<span class="w">      </span><span class="m">0</span>.533<span class="w">      </span><span class="m">0</span>.533<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
K_C<span class="w">	 </span><span class="m">1000</span>.0<span class="w">       </span><span class="m">0</span>.743<span class="w">      </span><span class="m">0</span>.743<span class="w">      </span><span class="m">0</span>.743<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000

K_T<span class="w">	  </span><span class="m">300</span>.0<span class="w">       </span><span class="m">2</span>.447<span class="w">      </span><span class="m">2</span>.447<span class="w">      </span><span class="m">2</span>.447<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
K_T<span class="w">	 </span><span class="m">1000</span>.0<span class="w">       </span><span class="m">1</span>.314<span class="w">      </span><span class="m">1</span>.314<span class="w">      </span><span class="m">1</span>.314<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
...
</pre></div>
</div>
<p>The calculation in this example shows that it is crucial to account for both the particle-like and wave-like contributions to accurately describe the ultra-low or glass-like conductivity of complex crystals such as La<span class="math notranslate nohighlight">\(_2\)</span>Zr<span class="math notranslate nohighlight">\(_2\)</span>O<span class="math notranslate nohighlight">\(_7\)</span>.
More details can be found in the <a class="reference internal" href="citation.html#citation-wigner-formulation"><span class="std std-ref">paper on the Wigner formulation</span></a>, which reports the following plot comparing predictions from the Wigner formulation and experiments over a broader temperature range:</p>
<a class="reference internal image-reference" href="_images/tc_Wigner_La2Zr2O7.png"><img alt="_images/tc_Wigner_La2Zr2O7.png" src="_images/tc_Wigner_La2Zr2O7.png" style="width: 70%;" />
</a>
<p>The experimental data are taken from Suresh et al., J. Nucl. Mater. 249, 259 (1997); Vassen et al., J. Am. Ceram. Soc. 83, 2023 (2000); Chen et al., J. Alloy Compd. 486, 391 (2009); Wan et al.,  Acta Mater. 58, 6166 (2010);
Yang et al., J. Eur. Ceram. Soc. 36, 3809 (2016); Zhang et al., Ceramics International 46, 4737 (2020).</p>
<p>As a second example, we show how to compute the solution of the Wigner transport equation treating scattering in the RTA approximation for <code class="docutils literal notranslate"><span class="pre">example/Si-PBEsol</span></code>; the command is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phono3py-load<span class="w"> </span>--mesh<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>--ts<span class="w"> </span><span class="m">1600</span><span class="w"> </span>--br<span class="w"> </span>--wigner
</pre></div>
</div>
<p>and the output is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
<span class="o">===================</span><span class="w"> </span>End<span class="w"> </span>of<span class="w"> </span>collection<span class="w"> </span>of<span class="w"> </span><span class="nv">collisions</span><span class="w"> </span><span class="o">===================</span>
-----------<span class="w"> </span>Thermal<span class="w"> </span>conductivity<span class="w"> </span><span class="o">(</span>W/m-k<span class="o">)</span><span class="w"> </span>with<span class="w"> </span>tetrahedron<span class="w"> </span>method<span class="w"> </span>-----------
<span class="c1">#           T(K)        xx         yy         zz         yz         xz         xy</span>
K_P<span class="w">    </span><span class="m">1600</span>.0<span class="w">      </span><span class="m">20</span>.059<span class="w">     </span><span class="m">20</span>.059<span class="w">     </span><span class="m">20</span>.059<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000

K_C<span class="w">    </span><span class="m">1600</span>.0<span class="w">       </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000

K_T<span class="w">    </span><span class="m">1600</span>.0<span class="w">      </span><span class="m">20</span>.335<span class="w">     </span><span class="m">20</span>.335<span class="w">     </span><span class="m">20</span>.335<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
...
</pre></div>
</div>
</section>
<section id="solution-of-the-wte-exact-treatment-of-scattering">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Solution of the WTE, exact treatment of scattering</a><a class="headerlink" href="#solution-of-the-wte-exact-treatment-of-scattering" title="Link to this heading">#</a></h3>
<p>To compute the Wigner conductivity treating scattering exactly, specify <code class="docutils literal notranslate"><span class="pre">--lbte</span></code> and <code class="docutils literal notranslate"><span class="pre">--wigner</span></code>. For <code class="docutils literal notranslate"><span class="pre">example/Si-PBEsol</span></code>, the command is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>%<span class="w"> </span>phono3py-load<span class="w"> </span>--mesh<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">11</span><span class="w"> </span>--ts<span class="w"> </span><span class="m">1600</span><span class="w"> </span>--lbte<span class="w"> </span>--wigner
</pre></div>
</div>
<p>and the output is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
<span class="o">===================</span><span class="w"> </span>End<span class="w"> </span>of<span class="w"> </span>collection<span class="w"> </span>of<span class="w"> </span><span class="nv">collisions</span><span class="w"> </span><span class="o">===================</span>
-<span class="w"> </span>Averaging<span class="w"> </span>collision<span class="w"> </span>matrix<span class="w"> </span>elements<span class="w"> </span>by<span class="w"> </span>phonon<span class="w"> </span>degeneracy<span class="w"> </span><span class="o">[</span><span class="m">0</span>.035s<span class="o">]</span>
-<span class="w"> </span>Making<span class="w"> </span>collision<span class="w"> </span>matrix<span class="w"> </span>symmetric<span class="w"> </span><span class="o">(</span>built-in<span class="o">)</span><span class="w"> </span><span class="o">[</span><span class="m">0</span>.000s<span class="o">]</span>
-----------<span class="w"> </span>Thermal<span class="w"> </span>conductivity<span class="w"> </span><span class="o">(</span>W/m-k<span class="o">)</span><span class="w"> </span>with<span class="w"> </span>tetrahedron<span class="w"> </span>method<span class="w"> </span>-----------
Diagonalizing<span class="w"> </span>by<span class="w"> </span>lapacke<span class="w"> </span>dsyev...<span class="w"> </span><span class="o">[</span><span class="m">0</span>.148s<span class="o">]</span>
Calculating<span class="w"> </span>pseudo-inv<span class="w"> </span>with<span class="w"> </span><span class="nv">cutoff</span><span class="o">=</span><span class="m">1</span>.0e-08<span class="w"> </span><span class="o">(</span>np.dot<span class="o">)</span><span class="w"> </span><span class="o">[</span><span class="m">0</span>.002s<span class="o">]</span>
<span class="c1">#                T(K)        xx         yy         zz         yz         xz         xy</span>
K_P_exact<span class="w">       </span><span class="m">1600</span>.0<span class="w">      </span><span class="m">21</span>.009<span class="w">     </span><span class="m">21</span>.009<span class="w">     </span><span class="m">21</span>.009<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
<span class="o">(</span>K_P_RTA<span class="o">)</span><span class="w">       </span><span class="m">1600</span>.0<span class="w">      </span><span class="m">20</span>.059<span class="w">     </span><span class="m">20</span>.059<span class="w">     </span><span class="m">20</span>.059<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
K_C<span class="w">             </span><span class="m">1600</span>.0<span class="w">       </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.277<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000

<span class="nv">K_TOT</span><span class="o">=</span>K_P_exact+K_C<span class="w">   </span><span class="m">1600</span>.0<span class="w">      </span><span class="m">21</span>.286<span class="w">     </span><span class="m">21</span>.286<span class="w">     </span><span class="m">21</span>.286<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000<span class="w">      </span><span class="m">0</span>.000
----------------------------------------------------------------------------
...
</pre></div>
</div>
<p>We note that usually in materials with ultralow or glass-like conductivity (<span class="math notranslate nohighlight">\(\kappa_T\lesssim 2\frac{W}{m\cdot K}\)</span>) treating scattering in the RTA approximation or exactly gives results that are practically equivalent (see <a class="reference internal" href="citation.html#citation-wigner-formulation"><span class="std std-ref">paper on the Wigner formulation</span></a> and references therein).</p>
</section>
</section>
<section id="computational-cost">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Computational cost</a><a class="headerlink" href="#computational-cost" title="Link to this heading">#</a></h2>
<p>Using the code with the <code class="docutils literal notranslate"><span class="pre">--wigner</span></code> option has a negligible effect on the duration of the calculation.</p>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="direct-solution.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Direct solution of linearized phonon Boltzmann equation</p>
      </div>
    </a>
    <a class="right-next"
       href="workload-distribution.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Workload distribution</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-use">How to use</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-the-wte-scattering-in-the-rta-approximation">Solution of the WTE, scattering in the RTA approximation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#solution-of-the-wte-exact-treatment-of-scattering">Solution of the WTE, exact treatment of scattering</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computational-cost">Computational cost</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Author name not set
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2015, Atsushi Togo.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>